"use strict";function insert_at_caret(e,t){var a,l=document.getElementById(e),i=l.scrollTop,r=0,o=l.selectionStart||"0"===l.selectionStart?"ff":!!document.selection&&"ie";"ie"===o?(l.focus(),a=document.selection.createRange(),a.moveStart("character",-l.value.length),r=a.text.length):"ff"===o&&(r=l.selectionStart);var n=l.value.substring(0,r),c=l.value.substring(r,l.value.length);l.value=n+t+c,r+=t.length,"ie"===o?(l.focus(),a=document.selection.createRange(),a.moveStart("character",-l.value.length),a.moveStart("character",r),a.moveEnd("character",0),a.select()):"ff"===o&&(l.selectionStart=r,l.selectionEnd=r,l.focus()),l.scrollTop=i}function inject_email_template(e,t){$.each(t,function(t,a){t=t.replace("email_template_",""),a&&e.indexOf(t)>-1&&("body"===t?$("#"+t).html(a):"pdf_template"===t?$("#"+t).val(a).trigger("change"):$("#"+t).val(a))})}function update_email_template_preview(){$("#email-template-preview").contents().find("body").html($(".email-template-body").val())}function insert_html_tag(e,t){var a,l,i,r,o,n,c,s,d;switch(e){case"text-bold":a=["<b>","</b>"];break;case"text-italic":a=["<em>","</em>"];break;case"text-paragraph":a=["<p>","</p>"];break;case"text-h1":a=["<h1>","</h1>"];break;case"text-h2":a=["<h2>","</h2>"];break;case"text-h3":a=["<h3>","</h3>"];break;case"text-h4":a=["<h4>","</h4>"];break;case"text-code":a=["<code>","</code>"];break;case"text-hr":a=["<hr/>",""];break;case"text-css":a=["<style></style>",""]}return i=document.getElementById(t),void 0!==document.selection?(i.focus(),l=document.selection.createRange(),r=l.text):""!==i.selectionStart&&(o=i.selectionStart,n=i.selectionEnd,r=i.value.substring(o,n)),"text-css"===e?(c=a[0]+"\n\r"+i.value,$(i).val(c),update_email_template_preview(),!0):0===a[1].length?(insert_at_caret(t,a[0]),update_email_template_preview(),!0):void(r&&r.length?(s=a[0]+r+a[1],d=i.value.length,c=i.value.substring(0,o)+s+i.value.substring(n,d),$(i).val(c),update_email_template_preview()):(a=a[0]+a[1],insert_at_caret(t,a),update_email_template_preview()))}$(document).ready(function(){$.ajaxPrefilter(function(e){"post"!==e.type&&"POST"!==e.type&&"Post"!==e.type||(""===e.data?e.data+="?_ip_csrf="+Cookies.get("ip_csrf_cookie"):e.data+="&_ip_csrf="+Cookies.get("ip_csrf_cookie"))}),$(document).ajaxComplete(function(){$('[name="_ip_csrf"]').val(Cookies.get("ip_csrf_cookie"))});var e=$("#content"),t=$("html"),a=t.outerHeight(),l=$(".navbar").outerHeight(),i=$("#headerbar").outerHeight(),r=$("#submenu").outerHeight(),o=a-l-i-r;e.outerHeight()<o&&e.outerHeight(o),t.click(function(){$(".dropdown-menu:visible").not(".datepicker").removeAttr("style")}),$('[data-toggle="tooltip"]').tooltip(),$(".simple-select").select2();new Clipboard(".to-clipboard");$(".taggable").on("focus",function(){window.lastTaggableClicked=this}),$(".tag-select").select2().on("change",function(e){var t=$(e.currentTarget);return void 0!==window.lastTaggableClicked&&insert_at_caret(window.lastTaggableClicked.id,t.val()),t.val([]),!1}),$(".html-tag").click(function(){var e=$(this).data("tagType"),t=$(".email-template-body").attr("id");insert_html_tag(e,t)});var n=$(".email-template-body").attr("id");$("#email_template_preview").empty()&&update_email_template_preview(),$(n).bind("input propertychange",function(){update_email_template_preview()}),$("#email-template-preview-reload").click(function(){update_email_template_preview()}),$(document).on("click",".ajax-loader",function(e){var t=$(this).closest("form");if(t.length&&!t[0].checkValidity())return e.preventDefault(),e.stopImmediatePropagation(),t[0].reportValidity(),!1;$("#fullpage-loader").fadeIn(200),window.fullpageloaderTimeout=window.setTimeout(function(){$("#loader-error").fadeIn(200),$("#loader-icon").removeClass("fa-spin").addClass("text-danger")},1e4)}),$(document).on("click",".fullpage-loader-close",function(){$("#fullpage-loader").fadeOut(200),$("#loader-error").hide(),$("#loader-icon").addClass("fa-spin").removeClass("text-danger"),clearTimeout(window.fullpageloaderTimeout)});var c=$(".passwordmeter-input");c&&c.on("input",function(){var e=zxcvbn(c.val());$(".passmeter-2, .passmeter-3").hide(),4===e.score?$(".passmeter-2, .passmeter-3").show():3===e.score&&$(".passmeter-2").show()})});